{"version":3,"sources":["src/domHelpers.js","src/pages.js","src/transform.js","node_modules/alloyfinger/alloy_finger.js","src/cropBox.js","src/index.js"],"names":["toArray","Function","prototype","bind","call","slice","qsa","selector","element","document","body","querySelectorAll","addClass","el","className","classList","add","removeClass","remove","on","type","listener","capture","addEventListener","removeEventListener","css","obj","key","style","CACHED","resolveEvents","container","resolved","events","Object","entries","map","split","querySelector","loadPage","page","param","_unlistens","forEach","f","_onCached","render","cached","Matrix3D","n11","n12","n13","n14","n21","n22","n23","n24","n31","n32","n33","n34","n41","n42","n43","n44","elements","window","Float32Array","te","undefined","observe","target","props","callback","i","len","length","watch","prop","defineProperty","get","set","value","DEG_TO_RAD","Math","PI","identity","multiplyMatrices","a","be","ae","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","_rounded","pow","round","appendTransform","x","y","z","scaleX","scaleY","scaleZ","rotateX","rotateY","rotateZ","skewX","skewY","originX","originY","originZ","rx","cosx","cos","sinx","sin","ry","cosy","siny","rz","cosz","sinz","Transform","mtx","matrix3D","translateX","translateY","translateZ","transform","msTransform","OTransform","MozTransform","webkitTransform","perspective","Array","join","getLen","v","sqrt","getRotateAngle","v1","v2","angle","getAngle","mr","r","dot","acos","cross","HandlerAdmin","handlers","wrapFunc","handler","handlerAdmin","push","del","splice","dispatch","apply","arguments","AlloyFinger","option","start","move","end","cancel","preV","pinchStartLen","zoom","isDoubleTap","noop","rotate","touchStart","multipointStart","multipointEnd","pinch","swipe","tap","doubleTap","longTap","singleTap","pressMove","twoFingerPressMove","touchMove","touchEnd","touchCancel","_cancelAllHandler","cancelAll","delta","last","now","tapTimeout","singleTapTimeout","longTapTimeout","swipeTimeout","x1","x2","y1","y2","preTapPosition","evt","touches","Date","pageX","pageY","abs","clearTimeout","_cancelLongTap","_cancelSingleTap","_preventTap","setTimeout","currentX","currentY","sCurrentX","sCurrentY","sx2","deltaX","deltaY","sy2","movedX","movedY","preventDefault","changedTouches","self","direction","_swipeDirection","off","destroy","module","exports","createBox","cropBox","createElement","color","textAlign","fontSize","textDecoration","visibility","transformImage","imgEl","rect","naturalWidth","naturalHeight","scaling_x","innerWidth","initScale","originScale","first","Finger","centerX","centerY","cr","getBoundingClientRect","offX","left","width","offY","top","height","preOriginX","preOriginY","e","console","log","boxOffY","documentElement","clientHeight","tempo","dw","dh","right","bottom","boxOffX","clientWidth","position","zIndex","innerHeight","marginLeft","marginTop","renderCover","cover","ctx","getContext","w","h","cw","ch","save","fillStyle","globalAlpha","fillRect","restore","globalCompositeOperation","beginPath","fill","strokeStyle","stroke","drawCrop","cropRect","output","drawImage","calculateRect","c_left","c_top","cover_rect","img_rect","intersect_rect","getOverlap","concat","ax1","ay1","ax2","ay2","bx1","by1","bx2","by2","max","min","onFileChange","currentFiles","files","crop","imageSrc","URL","createObjectURL","home","pageName","result","appendChild","src","onload","prevBox","removeChild","location","reload","resultCanvas"],"mappings":"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","file":"src.28ea51fc.map","sourceRoot":"..","sourcesContent":["let toArray = Function.prototype.bind.call(Function.prototype.call, [].slice);\r\n\r\n/**\r\n * \r\n * @param {string} selector \r\n * @param {HTMLElement} element \r\n * @returns {HTMLElement[]}\r\n */\r\nexport function qsa (selector, element = document.body) {\r\n    return toArray(element.querySelectorAll(selector));\r\n}\r\n\r\n/**\r\n * \r\n * @param {HTMLElement} el \r\n * @param {string} className \r\n */\r\nexport function addClass (el, className) {\r\n    el.classList.add(className);\r\n}\r\n\r\n/**\r\n * \r\n * @param {HTMLElement} el \r\n * @param {string} className \r\n */\r\nexport function removeClass (el, className) {\r\n    el.classList.remove(className);\r\n}\r\n\r\n/**\r\n * \r\n * @param {HTMLElement} el \r\n * @param {string} type \r\n * @param {Function} listener \r\n * @param {boolean} [capture=false]\r\n */\r\nexport function on (el, type, listener, capture = false) {\r\n    el.addEventListener(type, listener);\r\n    return () => {\r\n        el.removeEventListener(type, listener, capture);\r\n    };\r\n}\r\n\r\n/**\r\n * 修改样式\r\n * @param {HTMLElement} el\r\n * @param {object<string>} obj\r\n */\r\nexport function css (el, obj) {\r\n    for (let key in obj) {\r\n        el.style[key] = obj[key];\r\n    }\r\n}\r\n","\r\nimport { qsa, addClass, removeClass, on } from './domHelpers';\r\n\r\nconst CACHED = 'cached';\r\n\r\nfunction resolveEvents ({ container, events }) {\r\n    const resolved = events(container);\r\n\r\n    return resolved\r\n        ? Object.entries(resolved).map(([key, listener]) => {\r\n            const [selector, type] = key.split(':');\r\n            return on(container.querySelector(selector), type, listener);\r\n        })\r\n        : [];\r\n}\r\n\r\n/**\r\n * @typedef {Object} Page\r\n * @prop {HTMLElement} container\r\n * @prop {(container: HTMLElement) => Object} events\r\n * @prop {(container: HTMLElement, param) => void} render\r\n * @prop {(container: HTMLElement) => void} cached\r\n *\r\n * @param {Page} page \r\n */\r\nexport function loadPage (page, param) {\r\n    const notCached = qsa('.page:not(.cached)');\r\n    notCached.map(el => {\r\n        addClass(el, CACHED); // cached\r\n        if (el._unlistens) { // unlisten\r\n            el._unlistens.forEach(f => f());\r\n            el._unlistens = null;\r\n        }\r\n        el._onCached && el._onCached(el); // cache hook\r\n    });\r\n\r\n    removeClass(page.container, CACHED);\r\n    page.container._unlistens = resolveEvents(page);\r\n    page.render(page.container, param);\r\n    page.container._onCached = page.cached;\r\n}\r\n","/* transformjs\r\n * By dntzhang\r\n * http://alloyteam.github.io/AlloyTouch/transformjs/\r\n */\r\n; (function () {\r\n\r\n  var Matrix3D = function (n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44) {\r\n    this.elements = window.Float32Array ? new Float32Array(16) : [];\r\n    var te = this.elements;\r\n    te[0] = (n11 !== undefined) ? n11 : 1; te[4] = n12 || 0; te[8] = n13 || 0; te[12] = n14 || 0;\r\n    te[1] = n21 || 0; te[5] = (n22 !== undefined) ? n22 : 1; te[9] = n23 || 0; te[13] = n24 || 0;\r\n    te[2] = n31 || 0; te[6] = n32 || 0; te[10] = (n33 !== undefined) ? n33 : 1; te[14] = n34 || 0;\r\n    te[3] = n41 || 0; te[7] = n42 || 0; te[11] = n43 || 0; te[15] = (n44 !== undefined) ? n44 : 1;\r\n  };\r\n\r\n  Matrix3D.DEG_TO_RAD = Math.PI / 180;\r\n\r\n  Matrix3D.prototype = {\r\n    set: function (n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44) {\r\n      var te = this.elements;\r\n      te[0] = n11; te[4] = n12; te[8] = n13; te[12] = n14;\r\n      te[1] = n21; te[5] = n22; te[9] = n23; te[13] = n24;\r\n      te[2] = n31; te[6] = n32; te[10] = n33; te[14] = n34;\r\n      te[3] = n41; te[7] = n42; te[11] = n43; te[15] = n44;\r\n      return this;\r\n    },\r\n    identity: function () {\r\n      this.set(\r\n        1, 0, 0, 0,\r\n        0, 1, 0, 0,\r\n        0, 0, 1, 0,\r\n        0, 0, 0, 1\r\n      );\r\n      return this;\r\n    },\r\n    multiplyMatrices: function (a, be) {\r\n\r\n      var ae = a.elements;\r\n      var te = this.elements;\r\n      var a11 = ae[0], a12 = ae[4], a13 = ae[8], a14 = ae[12];\r\n      var a21 = ae[1], a22 = ae[5], a23 = ae[9], a24 = ae[13];\r\n      var a31 = ae[2], a32 = ae[6], a33 = ae[10], a34 = ae[14];\r\n      var a41 = ae[3], a42 = ae[7], a43 = ae[11], a44 = ae[15];\r\n\r\n      var b11 = be[0], b12 = be[1], b13 = be[2], b14 = be[3];\r\n      var b21 = be[4], b22 = be[5], b23 = be[6], b24 = be[7];\r\n      var b31 = be[8], b32 = be[9], b33 = be[10], b34 = be[11];\r\n      var b41 = be[12], b42 = be[13], b43 = be[14], b44 = be[15];\r\n\r\n      te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n      te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n      te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n      te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n      te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n      te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n      te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n      te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n      te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n      te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n      te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n      te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n      te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n      te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n      te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n      te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n      return this;\r\n\r\n    },\r\n    // 解决角度为90的整数倍导致Math.cos得到极小的数，其实是0。导致不渲染\r\n    _rounded: function (value, i) {\r\n      i = Math.pow(10, i || 15);\r\n      // default\r\n      return Math.round(value * i) / i;\r\n    },\r\n    appendTransform: function (x, y, z, scaleX, scaleY, scaleZ, rotateX, rotateY, rotateZ, skewX, skewY, originX, originY, originZ) {\r\n\r\n      var rx = rotateX * Matrix3D.DEG_TO_RAD;\r\n      var cosx = this._rounded(Math.cos(rx));\r\n      var sinx = this._rounded(Math.sin(rx));\r\n      var ry = rotateY * Matrix3D.DEG_TO_RAD;\r\n      var cosy = this._rounded(Math.cos(ry));\r\n      var siny = this._rounded(Math.sin(ry));\r\n      var rz = rotateZ * Matrix3D.DEG_TO_RAD;\r\n      var cosz = this._rounded(Math.cos(rz * -1));\r\n      var sinz = this._rounded(Math.sin(rz * -1));\r\n\r\n      this.multiplyMatrices(this, [\r\n        1, 0, 0, x,\r\n        0, cosx, sinx, y,\r\n        0, -sinx, cosx, z,\r\n        0, 0, 0, 1\r\n      ]);\r\n\r\n      this.multiplyMatrices(this, [\r\n        cosy, 0, siny, 0,\r\n        0, 1, 0, 0,\r\n        -siny, 0, cosy, 0,\r\n        0, 0, 0, 1\r\n      ]);\r\n\r\n      this.multiplyMatrices(this, [\r\n        cosz * scaleX, sinz * scaleY, 0, 0,\r\n        -sinz * scaleX, cosz * scaleY, 0, 0,\r\n        0, 0, 1 * scaleZ, 0,\r\n        0, 0, 0, 1\r\n      ]);\r\n\r\n      if (skewX || skewY) {\r\n        this.multiplyMatrices(this, [\r\n          this._rounded(Math.cos(skewX * Matrix3D.DEG_TO_RAD)), this._rounded(Math.sin(skewX * Matrix3D.DEG_TO_RAD)), 0, 0,\r\n          -1 * this._rounded(Math.sin(skewY * Matrix3D.DEG_TO_RAD)), this._rounded(Math.cos(skewY * Matrix3D.DEG_TO_RAD)), 0, 0,\r\n          0, 0, 1, 0,\r\n          0, 0, 0, 1\r\n        ]);\r\n      }\r\n\r\n      if (originX || originY || originZ) {\r\n        this.elements[12] -= originX * this.elements[0] + originY * this.elements[4] + originZ * this.elements[8];\r\n        this.elements[13] -= originX * this.elements[1] + originY * this.elements[5] + originZ * this.elements[9];\r\n        this.elements[14] -= originX * this.elements[2] + originY * this.elements[6] + originZ * this.elements[10];\r\n      }\r\n      return this;\r\n    }\r\n  };\r\n\r\n  function observe (target, props, callback) {\r\n    for (var i = 0, len = props.length; i < len; i++) {\r\n      var prop = props[i];\r\n      watch(target, prop, callback);\r\n    }\r\n  }\r\n\r\n  function watch (target, prop, callback) {\r\n    Object.defineProperty(target, prop, {\r\n      get: function () {\r\n        return this[\"__\" + prop];\r\n      },\r\n      set: function (value) {\r\n        if (value !== this[\"__\" + prop]) {\r\n          this[\"__\" + prop] = value;\r\n          callback();\r\n        }\r\n\r\n      }\r\n    });\r\n  }\r\n\r\n  window.Transform = function (element) {\r\n\r\n    observe(\r\n      element,\r\n      [\"translateX\", \"translateY\", \"translateZ\", \"scaleX\", \"scaleY\", \"scaleZ\", \"rotateX\", \"rotateY\", \"rotateZ\", \"skewX\", \"skewY\", \"originX\", \"originY\", \"originZ\"],\r\n      function () {\r\n        var mtx = element.matrix3D.identity().appendTransform(element.translateX, element.translateY, element.translateZ, element.scaleX, element.scaleY, element.scaleZ, element.rotateX, element.rotateY, element.rotateZ, element.skewX, element.skewY, element.originX, element.originY, element.originZ);\r\n        element.style.transform = element.style.msTransform = element.style.OTransform = element.style.MozTransform = element.style.webkitTransform = \"perspective(\" + element.perspective + \"px) matrix3d(\" + Array.prototype.slice.call(mtx.elements).join(\",\") + \")\";\r\n      });\r\n\r\n    observe(\r\n      element,\r\n      [\"perspective\"],\r\n      function () {\r\n        element.style.transform = element.style.msTransform = element.style.OTransform = element.style.MozTransform = element.style.webkitTransform = \"perspective(\" + element.perspective + \"px) matrix3d(\" + Array.prototype.slice.call(element.matrix3D.elements).join(\",\") + \")\";\r\n      });\r\n\r\n    element.matrix3D = new Matrix3D();\r\n    element.perspective = 500;\r\n    element.scaleX = element.scaleY = element.scaleZ = 1;\r\n    //由于image自带了x\\y\\z，所有加上translate前缀\r\n    element.translateX = element.translateY = element.translateZ = element.rotateX = element.rotateY = element.rotateZ = element.skewX = element.skewY = element.originX = element.originY = element.originZ = 0;\r\n  }\r\n})();","/* AlloyFinger v0.1.15\r\n * By dntzhang\r\n * Github: https://github.com/AlloyTeam/AlloyFinger\r\n */\r\n; (function () {\r\n    function getLen(v) {\r\n        return Math.sqrt(v.x * v.x + v.y * v.y);\r\n    }\r\n\r\n    function dot(v1, v2) {\r\n        return v1.x * v2.x + v1.y * v2.y;\r\n    }\r\n\r\n    function getAngle(v1, v2) {\r\n        var mr = getLen(v1) * getLen(v2);\r\n        if (mr === 0) return 0;\r\n        var r = dot(v1, v2) / mr;\r\n        if (r > 1) r = 1;\r\n        return Math.acos(r);\r\n    }\r\n\r\n    function cross(v1, v2) {\r\n        return v1.x * v2.y - v2.x * v1.y;\r\n    }\r\n\r\n    function getRotateAngle(v1, v2) {\r\n        var angle = getAngle(v1, v2);\r\n        if (cross(v1, v2) > 0) {\r\n            angle *= -1;\r\n        }\r\n\r\n        return angle * 180 / Math.PI;\r\n    }\r\n\r\n    var HandlerAdmin = function(el) {\r\n        this.handlers = [];\r\n        this.el = el;\r\n    };\r\n\r\n    HandlerAdmin.prototype.add = function(handler) {\r\n        this.handlers.push(handler);\r\n    }\r\n\r\n    HandlerAdmin.prototype.del = function(handler) {\r\n        if(!handler) this.handlers = [];\r\n\r\n        for(var i=this.handlers.length; i>=0; i--) {\r\n            if(this.handlers[i] === handler) {\r\n                this.handlers.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    HandlerAdmin.prototype.dispatch = function() {\r\n        for(var i=0,len=this.handlers.length; i<len; i++) {\r\n            var handler = this.handlers[i];\r\n            if(typeof handler === 'function') handler.apply(this.el, arguments);\r\n        }\r\n    }\r\n\r\n    function wrapFunc(el, handler) {\r\n        var handlerAdmin = new HandlerAdmin(el);\r\n        handlerAdmin.add(handler);\r\n\r\n        return handlerAdmin;\r\n    }\r\n\r\n    var AlloyFinger = function (el, option) {\r\n\r\n        this.element = typeof el == 'string' ? document.querySelector(el) : el;\r\n\r\n        this.start = this.start.bind(this);\r\n        this.move = this.move.bind(this);\r\n        this.end = this.end.bind(this);\r\n        this.cancel = this.cancel.bind(this);\r\n        this.element.addEventListener(\"touchstart\", this.start, false);\r\n        this.element.addEventListener(\"touchmove\", this.move, false);\r\n        this.element.addEventListener(\"touchend\", this.end, false);\r\n        this.element.addEventListener(\"touchcancel\", this.cancel, false);\r\n\r\n        this.preV = { x: null, y: null };\r\n        this.pinchStartLen = null;\r\n        this.zoom = 1;\r\n        this.isDoubleTap = false;\r\n\r\n        var noop = function () { };\r\n\r\n        this.rotate = wrapFunc(this.element, option.rotate || noop);\r\n        this.touchStart = wrapFunc(this.element, option.touchStart || noop);\r\n        this.multipointStart = wrapFunc(this.element, option.multipointStart || noop);\r\n        this.multipointEnd = wrapFunc(this.element, option.multipointEnd || noop);\r\n        this.pinch = wrapFunc(this.element, option.pinch || noop);\r\n        this.swipe = wrapFunc(this.element, option.swipe || noop);\r\n        this.tap = wrapFunc(this.element, option.tap || noop);\r\n        this.doubleTap = wrapFunc(this.element, option.doubleTap || noop);\r\n        this.longTap = wrapFunc(this.element, option.longTap || noop);\r\n        this.singleTap = wrapFunc(this.element, option.singleTap || noop);\r\n        this.pressMove = wrapFunc(this.element, option.pressMove || noop);\r\n        this.twoFingerPressMove = wrapFunc(this.element, option.twoFingerPressMove || noop);\r\n        this.touchMove = wrapFunc(this.element, option.touchMove || noop);\r\n        this.touchEnd = wrapFunc(this.element, option.touchEnd || noop);\r\n        this.touchCancel = wrapFunc(this.element, option.touchCancel || noop);\r\n\r\n        this._cancelAllHandler = this.cancelAll.bind(this);\r\n\r\n        window.addEventListener('scroll', this._cancelAllHandler);\r\n\r\n        this.delta = null;\r\n        this.last = null;\r\n        this.now = null;\r\n        this.tapTimeout = null;\r\n        this.singleTapTimeout = null;\r\n        this.longTapTimeout = null;\r\n        this.swipeTimeout = null;\r\n        this.x1 = this.x2 = this.y1 = this.y2 = null;\r\n        this.preTapPosition = { x: null, y: null };\r\n    };\r\n\r\n    AlloyFinger.prototype = {\r\n        start: function (evt) {\r\n            if (!evt.touches) return;\r\n            this.now = Date.now();\r\n            this.x1 = evt.touches[0].pageX;\r\n            this.y1 = evt.touches[0].pageY;\r\n            this.delta = this.now - (this.last || this.now);\r\n            this.touchStart.dispatch(evt, this.element);\r\n            if (this.preTapPosition.x !== null) {\r\n                this.isDoubleTap = (this.delta > 0 && this.delta <= 250 && Math.abs(this.preTapPosition.x - this.x1) < 30 && Math.abs(this.preTapPosition.y - this.y1) < 30);\r\n                if (this.isDoubleTap) clearTimeout(this.singleTapTimeout);\r\n            }\r\n            this.preTapPosition.x = this.x1;\r\n            this.preTapPosition.y = this.y1;\r\n            this.last = this.now;\r\n            var preV = this.preV,\r\n                len = evt.touches.length;\r\n            if (len > 1) {\r\n                this._cancelLongTap();\r\n                this._cancelSingleTap();\r\n                var v = { x: evt.touches[1].pageX - this.x1, y: evt.touches[1].pageY - this.y1 };\r\n                preV.x = v.x;\r\n                preV.y = v.y;\r\n                this.pinchStartLen = getLen(preV);\r\n                this.multipointStart.dispatch(evt, this.element);\r\n            }\r\n            this._preventTap = false;\r\n            this.longTapTimeout = setTimeout(function () {\r\n                this.longTap.dispatch(evt, this.element);\r\n                this._preventTap = true;\r\n            }.bind(this), 750);\r\n        },\r\n        move: function (evt) {\r\n            if (!evt.touches) return;\r\n            var preV = this.preV,\r\n                len = evt.touches.length,\r\n                currentX = evt.touches[0].pageX,\r\n                currentY = evt.touches[0].pageY;\r\n            this.isDoubleTap = false;\r\n            if (len > 1) {\r\n                var sCurrentX = evt.touches[1].pageX,\r\n                    sCurrentY = evt.touches[1].pageY\r\n                var v = { x: evt.touches[1].pageX - currentX, y: evt.touches[1].pageY - currentY };\r\n\r\n                if (preV.x !== null) {\r\n                    if (this.pinchStartLen > 0) {\r\n                        evt.zoom = getLen(v) / this.pinchStartLen;\r\n                        this.pinch.dispatch(evt, this.element);\r\n                    }\r\n\r\n                    evt.angle = getRotateAngle(v, preV);\r\n                    this.rotate.dispatch(evt, this.element);\r\n                }\r\n                preV.x = v.x;\r\n                preV.y = v.y;\r\n\r\n                if (this.x2 !== null && this.sx2 !== null) {\r\n                    evt.deltaX = (currentX - this.x2 + sCurrentX - this.sx2) / 2;\r\n                    evt.deltaY = (currentY - this.y2 + sCurrentY - this.sy2) / 2;\r\n                } else {\r\n                    evt.deltaX = 0;\r\n                    evt.deltaY = 0;\r\n                }\r\n                this.twoFingerPressMove.dispatch(evt, this.element);\r\n\r\n                this.sx2 = sCurrentX;\r\n                this.sy2 = sCurrentY;\r\n            } else {\r\n                if (this.x2 !== null) {\r\n                    evt.deltaX = currentX - this.x2;\r\n                    evt.deltaY = currentY - this.y2;\r\n\r\n                    //move事件中添加对当前触摸点到初始触摸点的判断，\r\n                    //如果曾经大于过某个距离(比如10),就认为是移动到某个地方又移回来，应该不再触发tap事件才对。\r\n                    var movedX = Math.abs(this.x1 - this.x2),\r\n                        movedY = Math.abs(this.y1 - this.y2);\r\n\r\n                    if(movedX > 10 || movedY > 10){\r\n                        this._preventTap = true;\r\n                    }\r\n\r\n                } else {\r\n                    evt.deltaX = 0;\r\n                    evt.deltaY = 0;\r\n                }\r\n                \r\n                \r\n                this.pressMove.dispatch(evt, this.element);\r\n            }\r\n\r\n            this.touchMove.dispatch(evt, this.element);\r\n\r\n            this._cancelLongTap();\r\n            this.x2 = currentX;\r\n            this.y2 = currentY;\r\n            \r\n            if (len > 1) {\r\n                evt.preventDefault();\r\n            }\r\n        },\r\n        end: function (evt) {\r\n            if (!evt.changedTouches) return;\r\n            this._cancelLongTap();\r\n            var self = this;\r\n            if (evt.touches.length < 2) {\r\n                this.multipointEnd.dispatch(evt, this.element);\r\n                this.sx2 = this.sy2 = null;\r\n            }\r\n\r\n            //swipe\r\n            if ((this.x2 && Math.abs(this.x1 - this.x2) > 30) ||\r\n                (this.y2 && Math.abs(this.y1 - this.y2) > 30)) {\r\n                evt.direction = this._swipeDirection(this.x1, this.x2, this.y1, this.y2);\r\n                this.swipeTimeout = setTimeout(function () {\r\n                    self.swipe.dispatch(evt, self.element);\r\n\r\n                }, 0)\r\n            } else {\r\n                this.tapTimeout = setTimeout(function () {\r\n                    if(!self._preventTap){\r\n                        self.tap.dispatch(evt, self.element);\r\n                    }\r\n                    // trigger double tap immediately\r\n                    if (self.isDoubleTap) {\r\n                        self.doubleTap.dispatch(evt, self.element);\r\n                        self.isDoubleTap = false;\r\n                    }\r\n                }, 0)\r\n\r\n                if (!self.isDoubleTap) {\r\n                    self.singleTapTimeout = setTimeout(function () {\r\n                        self.singleTap.dispatch(evt, self.element);\r\n                    }, 250);\r\n                }\r\n            }\r\n\r\n            this.touchEnd.dispatch(evt, this.element);\r\n\r\n            this.preV.x = 0;\r\n            this.preV.y = 0;\r\n            this.zoom = 1;\r\n            this.pinchStartLen = null;\r\n            this.x1 = this.x2 = this.y1 = this.y2 = null;\r\n        },\r\n        cancelAll: function () {\r\n            this._preventTap = true\r\n            clearTimeout(this.singleTapTimeout);\r\n            clearTimeout(this.tapTimeout);\r\n            clearTimeout(this.longTapTimeout);\r\n            clearTimeout(this.swipeTimeout);\r\n        },\r\n        cancel: function (evt) {\r\n            this.cancelAll()\r\n            this.touchCancel.dispatch(evt, this.element);\r\n        },\r\n        _cancelLongTap: function () {\r\n            clearTimeout(this.longTapTimeout);\r\n        },\r\n        _cancelSingleTap: function () {\r\n            clearTimeout(this.singleTapTimeout);\r\n        },\r\n        _swipeDirection: function (x1, x2, y1, y2) {\r\n            return Math.abs(x1 - x2) >= Math.abs(y1 - y2) ? (x1 - x2 > 0 ? 'Left' : 'Right') : (y1 - y2 > 0 ? 'Up' : 'Down')\r\n        },\r\n\r\n        on: function(evt, handler) {\r\n            if(this[evt]) {\r\n                this[evt].add(handler);\r\n            }\r\n        },\r\n\r\n        off: function(evt, handler) {\r\n            if(this[evt]) {\r\n                this[evt].del(handler);\r\n            }\r\n        },\r\n\r\n        destroy: function() {\r\n            if(this.singleTapTimeout) clearTimeout(this.singleTapTimeout);\r\n            if(this.tapTimeout) clearTimeout(this.tapTimeout);\r\n            if(this.longTapTimeout) clearTimeout(this.longTapTimeout);\r\n            if(this.swipeTimeout) clearTimeout(this.swipeTimeout);\r\n\r\n            this.element.removeEventListener(\"touchstart\", this.start);\r\n            this.element.removeEventListener(\"touchmove\", this.move);\r\n            this.element.removeEventListener(\"touchend\", this.end);\r\n            this.element.removeEventListener(\"touchcancel\", this.cancel);\r\n\r\n            this.rotate.del();\r\n            this.touchStart.del();\r\n            this.multipointStart.del();\r\n            this.multipointEnd.del();\r\n            this.pinch.del();\r\n            this.swipe.del();\r\n            this.tap.del();\r\n            this.doubleTap.del();\r\n            this.longTap.del();\r\n            this.singleTap.del();\r\n            this.pressMove.del();\r\n            this.twoFingerPressMove.del()\r\n            this.touchMove.del();\r\n            this.touchEnd.del();\r\n            this.touchCancel.del();\r\n\r\n            this.preV = this.pinchStartLen = this.zoom = this.isDoubleTap = this.delta = this.last = this.now = this.tapTimeout = this.singleTapTimeout = this.longTapTimeout = this.swipeTimeout = this.x1 = this.x2 = this.y1 = this.y2 = this.preTapPosition = this.rotate = this.touchStart = this.multipointStart = this.multipointEnd = this.pinch = this.swipe = this.tap = this.doubleTap = this.longTap = this.singleTap = this.pressMove = this.touchMove = this.touchEnd = this.touchCancel = this.twoFingerPressMove = null;\r\n\r\n            window.removeEventListener('scroll', this._cancelAllHandler);\r\n            return null;\r\n        }\r\n    };\r\n\r\n    if (typeof module !== 'undefined' && typeof exports === 'object') {\r\n        module.exports = AlloyFinger;\r\n    } else {\r\n        window.AlloyFinger = AlloyFinger;\r\n    }\r\n})();\r\n","/**\r\n * 此文件大部分代码引用自https://github.com/AlloyTeam/AlloyCrop/blob/master/alloy-crop.js\r\n */\r\n\r\nimport { css } from './domHelpers';\r\nimport './transform';\r\nimport Finger from 'alloyfinger';\r\n\r\n\r\nconst Transform = window.Transform;\r\n\r\n/**\r\n * 创建一个容器元素\r\n */\r\nexport function createBox () {\r\n    const cropBox = document.createElement('div');\r\n    cropBox.className = 'crop-box';\r\n\r\n    css(cropBox, {\r\n        color: 'white',\r\n        textAlign: 'center',\r\n        fontSize: '18px',\r\n        textDecoration: 'none',\r\n        visibility: 'visible'\r\n    });\r\n\r\n    return cropBox;\r\n}\r\n\r\n/**\r\n * 使图片可拖拽、缩放\r\n * @param {HTMLImageElement} imgEl\r\n * @param {{height: number, width: number}} rect 裁剪框尺寸，用于计算拖拽边界\r\n */\r\nexport function transformImage (imgEl, rect, cropBox) {\r\n    const naturalWidth = imgEl.naturalWidth;\r\n    const naturalHeight = imgEl.naturalHeight;\r\n\r\n    Transform(imgEl, true);\r\n\r\n    const scaling_x = window.innerWidth / naturalWidth;\r\n    let initScale = scaling_x;\r\n    const originScale = scaling_x;\r\n    imgEl.scaleX = imgEl.scaleY = scaling_x;\r\n    let first = 1;\r\n\r\n    // touch事件必须绑定到容器元素上，img在布局上被canvas遮挡\r\n    new Finger(cropBox, {\r\n        multipointStart: (evt) => {\r\n            var centerX = (evt.touches[0].pageX + evt.touches[1].pageX) / 2;\r\n            var centerY = (evt.touches[0].pageY + evt.touches[1].pageY) / 2;\r\n            var cr = imgEl.getBoundingClientRect();\r\n            var img_centerX = cr.left + cr.width / 2;\r\n            var img_centerY = cr.top + cr.height / 2;\r\n            var offX = centerX - img_centerX;\r\n            var offY = centerY - img_centerY;\r\n            var preOriginX = imgEl.originX;\r\n            var preOriginY = imgEl.originY;\r\n            imgEl.originX = offX / imgEl.scaleX;\r\n            imgEl.originY = offY / imgEl.scaleY;\r\n            //reset translateX and translateY\r\n\r\n            imgEl.translateX += offX - preOriginX * imgEl.scaleX;\r\n            imgEl.translateY += offY - preOriginY * imgEl.scaleX;\r\n\r\n\r\n            if (first == 1) {\r\n                imgEl.scaleX = imgEl.scaleY = initScale * 1.1;\r\n                ++first;\r\n            }\r\n\r\n            initScale = imgEl.scaleX;\r\n        },\r\n        rotate: (e) => {\r\n            console.log('TODO: rotate ', e);\r\n        },\r\n        pinch: (evt) => {\r\n            var cr = imgEl.getBoundingClientRect();\r\n            var boxOffY = (document.documentElement.clientHeight - rect.height) / 2;\r\n\r\n            var tempo = evt.zoom;\r\n            var dw = (cr.width * tempo - cr.width) / 2;\r\n            var dh = (cr.height - cr.height * tempo) / 2;\r\n            if ((initScale * tempo <= 1.6) && (initScale * tempo >= originScale) && (dw >= cr.left) && (-dw <= (cr.right - rect.width)) && (dh <= (boxOffY - cr.top)) && (dh <= (cr.bottom - boxOffY - rect.height))) {\r\n                imgEl.scaleX = imgEl.scaleY = initScale * tempo;\r\n            }\r\n        },\r\n        pressMove: (evt) => {\r\n            var cr = imgEl.getBoundingClientRect();\r\n            var boxOffY = (document.documentElement.clientHeight - rect.height) / 2;\r\n            if ((boxOffY - cr.top - evt.deltaY >= 0) && (cr.bottom + evt.deltaY - boxOffY >= rect.height)) {\r\n                imgEl.translateY += evt.deltaY;\r\n            }\r\n            var boxOffX = (document.documentElement.clientWidth - rect.width) / 2;\r\n            if ((cr.left + evt.deltaX <= boxOffX) && (cr.right + evt.deltaX - boxOffX >= rect.width)) {\r\n                imgEl.translateX += evt.deltaX;\r\n            }\r\n            evt.preventDefault();\r\n        }\r\n    });\r\n\r\n    css(imgEl, {\r\n        position: 'fixed',\r\n        zIndex: '99',\r\n        left: '50%',\r\n        top: window.innerHeight / 2 + 'px',\r\n        marginLeft: naturalWidth / -2 + 'px',\r\n        marginTop: naturalHeight / -2 + 'px'\r\n    });\r\n}\r\n\r\n/**\r\n * 遮罩和裁剪框采用一个canvas绘制\r\n * @param {HTMLCanvasElement} cover \r\n */\r\nexport function renderCover (cover, rect) {\r\n    const ctx = cover.getContext('2d');\r\n    const w = cover.width;\r\n    const h = cover.height;\r\n    const cw = rect.width;\r\n    const ch = rect.height;\r\n    ctx.save();\r\n    ctx.fillStyle = 'black';\r\n    ctx.globalAlpha = 0.7;\r\n    ctx.fillRect(0, 0, w, h);\r\n    ctx.restore();\r\n    ctx.save();\r\n    ctx.globalCompositeOperation = 'destination-out';\r\n    ctx.beginPath();\r\n    ctx.rect(w / 2 - cw / 2, h / 2 - ch / 2, cw, ch);\r\n    ctx.fill();\r\n    ctx.restore();\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = 'white';\r\n    ctx.rect(w / 2 - cw / 2, h / 2 - ch / 2, cw, ch);\r\n    ctx.stroke();\r\n\r\n    css(cover, {\r\n        position: 'fixed',\r\n        zIndex: '100',\r\n        left: '0px',\r\n        top: '0px'\r\n    });\r\n\r\n}\r\n\r\n/**\r\n * \r\n * @param {CanvasRenderingContext2D} ctx 绘制裁剪结果的context\r\n * @param {HTMLImageElement} imgEl \r\n * @param {number[]} cropRect\r\n * @param {number} [output=1.5] \r\n */\r\nexport function drawCrop (ctx, imgEl, cropRect, output = 1.5) {\r\n    ctx.drawImage(\r\n        imgEl,\r\n        cropRect[0],\r\n        cropRect[1],\r\n        cropRect[2],\r\n        cropRect[3],\r\n        0,\r\n        0,\r\n        cropRect[2] * imgEl.scaleX * output,\r\n        cropRect[3] * imgEl.scaleY * output\r\n    );\r\n}\r\n\r\n/**\r\n * \r\n * @param {HTMLImageElement} imgEl \r\n * @param {{height: number, width: number}} rect \r\n */\r\nexport function calculateRect (imgEl, rect) {\r\n    var cr = imgEl.getBoundingClientRect();\r\n    var c_left = window.innerWidth / 2 - rect.width / 2;\r\n    var c_top = window.innerHeight / 2 - rect.height / 2;\r\n    var cover_rect = [c_left, c_top, rect.width + c_left, rect.height + c_top];\r\n    var img_rect = [cr.left, cr.top, cr.width + cr.left, cr.height + cr.top];\r\n    var intersect_rect = getOverlap.apply(null, cover_rect.concat(img_rect));\r\n    var left = (intersect_rect[0] - img_rect[0]) / imgEl.scaleX;\r\n    var top = (intersect_rect[1] - img_rect[1]) / imgEl.scaleY;\r\n    var width = intersect_rect[2] / imgEl.scaleX;\r\n    var height = intersect_rect[3] / imgEl.scaleY;\r\n\r\n    if (left < 0) left = 0;\r\n    if (top < 0) top = 0;\r\n    if (left + width > imgEl.naturalWidth) width = imgEl.naturalWidth - left;\r\n    if (top + height > imgEl.naturalHeight) height = imgEl.naturalHeight - top;\r\n\r\n    return [left, top, width, height];\r\n}\r\n\r\nfunction getOverlap (ax1, ay1, ax2, ay2, bx1, by1, bx2, by2) {\r\n    if (ax2 < bx1 || ay2 < by1 || ax1 > bx2 || ay1 > by2) return [0, 0, 0, 0];\r\n\r\n    var left = Math.max(ax1, bx1);\r\n    var top = Math.max(ay1, by1);\r\n    var right = Math.min(ax2, bx2);\r\n    var bottom = Math.min(ay2, by2);\r\n    return [left, top, right - left, bottom - top];\r\n}\r\n","\r\nimport { loadPage } from './pages';\r\nimport { transformImage, renderCover, createBox, calculateRect, drawCrop } from './cropBox';\r\n\r\nconst rect = {\r\n    height: 200,\r\n    width: 100\r\n};\r\n\r\n// 首页\r\n\r\nconst onFileChange = (e) => {\r\n    const currentFiles = e.target.files;\r\n    if (currentFiles.length > 0) {\r\n        loadPage(crop, { imageSrc: window.URL.createObjectURL(currentFiles[0]) });\r\n    }\r\n};\r\n\r\nconst home = {\r\n    pageName: 'home',\r\n    container: document.body.querySelector('[data-page=home]'),\r\n    events() {\r\n        return {\r\n            // TODO: 处理选择同样图片的情况，同样图片不触发事件\r\n            '#imageLoader:change': onFileChange,\r\n            '#imageSelector:change': onFileChange\r\n        };\r\n    },\r\n    render() {\r\n    },\r\n    cached() {\r\n    }\r\n};\r\n\r\n// 裁剪\r\n\r\nconst crop = {\r\n    pageName: 'crop',\r\n    container: document.body.querySelector('[data-page=crop]'),\r\n    /**\r\n     * \r\n     * @param {HTMLElement} container \r\n     */\r\n    events(container) {\r\n        return {\r\n            '.button-cancel:click': () => {\r\n                loadPage(home);\r\n            },\r\n            '.button-ok:click': () => {\r\n                const imgEl = container.querySelector('.crop-image');\r\n                loadPage(result, { imgEl, cropRect: calculateRect(imgEl, rect) });\r\n            }\r\n        };\r\n    },\r\n    /**\r\n     * \r\n     * @param {HTMLElement} container \r\n     * @param {*} param1 \r\n     */\r\n    render(container, { imageSrc }) {\r\n        const cropBox = createBox();\r\n\r\n        // 加载图片\r\n        const imgEl = document.createElement('img');\r\n        imgEl.className = 'crop-image';\r\n        cropBox.appendChild(imgEl);\r\n        imgEl.src = imageSrc;\r\n        imgEl.onload = () => {\r\n            transformImage(imgEl, rect, cropBox);\r\n        };\r\n\r\n        // 创建canvas遮罩\r\n        const cover = document.createElement('canvas');\r\n        cover.width = window.innerWidth;\r\n        cover.height = window.innerHeight;\r\n        cropBox.appendChild(cover);\r\n        renderCover(cover, rect);\r\n\r\n        container.querySelector('.page-content').appendChild(cropBox);\r\n    },\r\n    /**\r\n     * \r\n     * @param {HTMLElement} container \r\n     */\r\n    cached(container) {\r\n        const prevBox = container.querySelector('.crop-box');\r\n        if (prevBox) {\r\n            container.querySelector('.page-content').removeChild(prevBox);\r\n        }\r\n    }\r\n};\r\n\r\n// result\r\n\r\nconst result = {\r\n    pageName: 'result',\r\n    container: document.body.querySelector('[data-page=result]'),\r\n    events() {\r\n        return {\r\n            '.button:click': () => {\r\n                location.reload();\r\n            }\r\n        };\r\n    },\r\n    /**\r\n     * \r\n     * @param {HTMLElement} container \r\n     * @param {{imgEl: HTMLElement, cropRect: number[]}} param1 \r\n     */\r\n    render(container, { imgEl, cropRect }) {\r\n        const resultCanvas = container.querySelector('#resultCanvas');\r\n        drawCrop(resultCanvas.getContext('2d'), imgEl, cropRect, 1.5);\r\n    }\r\n};\r\n\r\nloadPage(home);\r\n"]}